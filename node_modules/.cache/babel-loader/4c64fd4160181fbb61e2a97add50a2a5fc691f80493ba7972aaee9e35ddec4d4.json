{"ast":null,"code":"import React,{useRef,useState,useImperativeHandle}from'react';import{DragSource,DropTarget}from'react-dnd';import{useDispatch,useSelector}from'react-redux';import AddQuestionModal from'../AddQuestion';import{removeQuestion}from'../../slice';import'./styles.scss';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const QuestionUnit=/*#__PURE__*/React.forwardRef((_ref,ref)=>{let{questionDetails,createQuestionnaire,updateQuestionnaire,connectDropTarget,connectDragPreview,connectDragSource}=_ref;const elementRef=useRef();connectDropTarget(elementRef);useImperativeHandle(ref,()=>({getNode:()=>elementRef.current}));return connectDragPreview(/*#__PURE__*/_jsx(\"div\",{ref:elementRef,children:/*#__PURE__*/_jsx(QuestionBlock,{questionDetails:questionDetails,createQuestionnaire:createQuestionnaire,updateQuestionnaire:updateQuestionnaire,connectDragSource:connectDragSource})}));});const QuestionBlock=props=>{const{questionDetails,createQuestionnaire,updateQuestionnaire}=props;const[viewOptions,setViewOptions]=useState(false);const[showEditQuestionModal,setShowEditQuestionModal]=useState(false);const questions=useSelector(state=>state.reducer.screening.questions);const questionnaireId=useSelector(state=>state.reducer.screening.questionnaireId);const dispatch=useDispatch();const handleDelete=async()=>{const questionIds=[];for(const question of questions){if(question._id!==questionDetails._id){questionIds.push(question._id);}}try{await updateQuestionnaire(questionnaireId,questionIds);dispatch(removeQuestion(questionDetails._id));}catch(error){console.log(error);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"screening-question-block\",children:[props.connectDragSource(/*#__PURE__*/_jsx(\"i\",{className:\"icon-drag-and-drop\"})),/*#__PURE__*/_jsxs(\"div\",{className:\"added-question-block\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"screening-question-block-question-text\",children:questionDetails.question}),questionDetails.type<=3?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"screening-question-options-block\",children:/*#__PURE__*/_jsx(\"div\",{className:\"view-hide-option-toggle-btn\",onClick:()=>setViewOptions(!viewOptions),children:viewOptions?'Hide Options':'View Options'})}),/*#__PURE__*/_jsx(\"div\",{className:\"question-option-container \".concat(viewOptions?'visible':''),style:{maxHeight:viewOptions?23*questionDetails.answerOptions.length+'px':'0px'},children:(questionDetails.answerOptions||[]).map((option,index)=>/*#__PURE__*/_jsx(\"div\",{className:\"single-option-row\",children:option}))})]}):null]}),/*#__PURE__*/_jsxs(\"div\",{className:\"action-icons\",children:[questionDetails.mandatory?/*#__PURE__*/_jsx(\"i\",{className:\"icon-asterisk action-icon\"}):null,/*#__PURE__*/_jsx(\"i\",{className:\"icon-edit-1 action-icon\",onClick:()=>setShowEditQuestionModal(true),children:/*#__PURE__*/_jsx(\"div\",{className:\"screening-modal-container screening-actions-container \",children:showEditQuestionModal&&/*#__PURE__*/_jsx(AddQuestionModal,{handleClose:()=>setShowEditQuestionModal(false),createQuestionnaire:createQuestionnaire,updateQuestionnaire:updateQuestionnaire,questionDetails:questionDetails,isEditModal:true})})}),/*#__PURE__*/_jsx(\"i\",{className:\"icon-delete action-icon\",onClick:handleDelete})]})]},questionDetails._id);};// export default QuestionBlock;\nexport default DropTarget('item',{hover(props,monitor,component){if(!component){return null;}const node=component.getNode();if(!node){return null;}const dragIndex=monitor.getItem().index;const hoverIndex=props.index;console.log(dragIndex,hoverIndex);if(dragIndex===hoverIndex){return;}const hoverBoundingRect=node.getBoundingClientRect();const hoverMiddleY=(hoverBoundingRect.bottom-hoverBoundingRect.top)/2;const clientOffset=monitor.getClientOffset();const hoverClientY=clientOffset.y-hoverBoundingRect.top;if(dragIndex<hoverIndex&&hoverClientY<hoverMiddleY){return;}if(dragIndex>hoverIndex&&hoverClientY>hoverMiddleY){return;}props.reArrageQuestions(dragIndex,hoverIndex);monitor.getItem().index=hoverIndex;},drop(props){props.updateQuestionsOrder();}},connect=>({connectDropTarget:connect.dropTarget()}))(DragSource('item',{beginDrag:props=>({index:props.index})},(connect,monitor)=>({connectDragSource:connect.dragSource(),connectDragPreview:connect.dragPreview(),isDragging:monitor.isDragging()}))(QuestionUnit));","map":{"version":3,"names":["React","useRef","useState","useImperativeHandle","DragSource","DropTarget","useDispatch","useSelector","AddQuestionModal","removeQuestion","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","QuestionUnit","forwardRef","_ref","ref","questionDetails","createQuestionnaire","updateQuestionnaire","connectDropTarget","connectDragPreview","connectDragSource","elementRef","getNode","current","children","QuestionBlock","props","viewOptions","setViewOptions","showEditQuestionModal","setShowEditQuestionModal","questions","state","reducer","screening","questionnaireId","dispatch","handleDelete","questionIds","question","_id","push","error","console","log","className","type","onClick","concat","style","maxHeight","answerOptions","length","map","option","index","mandatory","handleClose","isEditModal","hover","monitor","component","node","dragIndex","getItem","hoverIndex","hoverBoundingRect","getBoundingClientRect","hoverMiddleY","bottom","top","clientOffset","getClientOffset","hoverClientY","y","reArrageQuestions","drop","updateQuestionsOrder","connect","dropTarget","beginDrag","dragSource","dragPreview","isDragging"],"sources":["/home/fa065132/GitHub/assessment-web/assessment-web-react/src/app/containers/Screening/Recruiter/components/QuestionBlock/index.jsx"],"sourcesContent":["import React, { useRef, useState, useImperativeHandle } from 'react';\nimport { DragSource, DropTarget } from 'react-dnd';\nimport { useDispatch, useSelector } from 'react-redux';\nimport AddQuestionModal from '../AddQuestion';\nimport { removeQuestion } from '../../slice';\n\nimport './styles.scss';\n\nconst QuestionUnit = React.forwardRef(\n    (\n        {\n            questionDetails,\n            createQuestionnaire,\n            updateQuestionnaire,\n            connectDropTarget,\n            connectDragPreview,\n            connectDragSource,\n        },\n        ref,\n    ) => {\n        const elementRef = useRef();\n\n        connectDropTarget(elementRef);\n\n        useImperativeHandle(ref, () => ({\n            getNode: () => elementRef.current,\n        }));\n        return connectDragPreview(\n            <div ref={elementRef}>\n                <QuestionBlock\n                    questionDetails={questionDetails}\n                    createQuestionnaire={createQuestionnaire}\n                    updateQuestionnaire={updateQuestionnaire}\n                    connectDragSource={connectDragSource}\n                />\n            </div>,\n        );\n    },\n);\n\nconst QuestionBlock = props => {\n    const { questionDetails, createQuestionnaire, updateQuestionnaire } = props;\n\n    const [viewOptions, setViewOptions] = useState(false);\n    const [showEditQuestionModal, setShowEditQuestionModal] = useState(false);\n\n    const questions = useSelector(state => state.reducer.screening.questions);\n    const questionnaireId = useSelector(\n        state => state.reducer.screening.questionnaireId,\n    );\n    const dispatch = useDispatch();\n\n    const handleDelete = async () => {\n        const questionIds = [];\n\n        for (const question of questions) {\n            if (question._id !== questionDetails._id) {\n                questionIds.push(question._id);\n            }\n        }\n\n        try {\n            await updateQuestionnaire(questionnaireId, questionIds);\n            dispatch(removeQuestion(questionDetails._id));\n        } catch (error) {\n            console.log(error);\n        }\n    };\n\n    return (\n        <div className=\"screening-question-block\" key={questionDetails._id}>\n            {props.connectDragSource(<i className=\"icon-drag-and-drop\"></i>)}\n            <div className=\"added-question-block\">\n                <div className=\"screening-question-block-question-text\">\n                    {questionDetails.question}\n                </div>\n                {questionDetails.type <= 3 ? (\n                    <>\n                        <div className=\"screening-question-options-block\">\n                            <div\n                                className=\"view-hide-option-toggle-btn\"\n                                onClick={() => setViewOptions(!viewOptions)}\n                            >\n                                {viewOptions ? 'Hide Options' : 'View Options'}\n                            </div>\n                        </div>\n                        {/* {viewOptions ? ( */}\n                        <div\n                            className={`question-option-container ${\n                                viewOptions ? 'visible' : ''\n                            }`}\n                            style={{\n                                maxHeight: viewOptions\n                                    ? 23 *\n                                          questionDetails.answerOptions.length +\n                                      'px'\n                                    : '0px',\n                            }}\n                        >\n                            {(questionDetails.answerOptions || []).map(\n                                (option, index) => (\n                                    <div className=\"single-option-row\">\n                                        {option}\n                                    </div>\n                                ),\n                            )}\n                        </div>\n                        {/* ) : null} */}\n                    </>\n                ) : null}\n            </div>\n            <div className=\"action-icons\">\n                {questionDetails.mandatory ? (\n                    <i className=\"icon-asterisk action-icon\"></i>\n                ) : null}\n                <i\n                    className=\"icon-edit-1 action-icon\"\n                    onClick={() => setShowEditQuestionModal(true)}\n                >\n                    <div className=\"screening-modal-container screening-actions-container \">\n                        {showEditQuestionModal && (\n                            <AddQuestionModal\n                                handleClose={() =>\n                                    setShowEditQuestionModal(false)\n                                }\n                                createQuestionnaire={createQuestionnaire}\n                                updateQuestionnaire={updateQuestionnaire}\n                                questionDetails={questionDetails}\n                                isEditModal={true}\n                            />\n                        )}\n                    </div>\n                </i>\n                <i\n                    className=\"icon-delete action-icon\"\n                    onClick={handleDelete}\n                ></i>\n            </div>\n        </div>\n    );\n};\n\n// export default QuestionBlock;\n\nexport default DropTarget(\n    'item',\n    {\n        hover(props, monitor, component) {\n            if (!component) {\n                return null;\n            }\n\n            const node = component.getNode();\n            if (!node) {\n                return null;\n            }\n            const dragIndex = monitor.getItem().index;\n            const hoverIndex = props.index;\n            console.log(dragIndex, hoverIndex);\n\n            if (dragIndex === hoverIndex) {\n                return;\n            }\n\n            const hoverBoundingRect = node.getBoundingClientRect();\n\n            const hoverMiddleY =\n                (hoverBoundingRect.bottom - hoverBoundingRect.top) / 2;\n\n            const clientOffset = monitor.getClientOffset();\n\n            const hoverClientY = clientOffset.y - hoverBoundingRect.top;\n\n            if (dragIndex < hoverIndex && hoverClientY < hoverMiddleY) {\n                return;\n            }\n\n            if (dragIndex > hoverIndex && hoverClientY > hoverMiddleY) {\n                return;\n            }\n\n            props.reArrageQuestions(dragIndex, hoverIndex);\n\n            monitor.getItem().index = hoverIndex;\n        },\n\n        drop(props) {\n            props.updateQuestionsOrder();\n        },\n    },\n    connect => ({\n        connectDropTarget: connect.dropTarget(),\n    }),\n)(\n    DragSource(\n        'item',\n        {\n            beginDrag: props => ({\n                index: props.index,\n            }),\n        },\n        (connect, monitor) => ({\n            connectDragSource: connect.dragSource(),\n            connectDragPreview: connect.dragPreview(),\n            isDragging: monitor.isDragging(),\n        }),\n    )(QuestionUnit),\n);\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}